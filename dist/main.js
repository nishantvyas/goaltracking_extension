(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function h(t){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(t)}function f(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function v(t){f(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||h(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function B(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function b(t){f(1,arguments);var e=v(t);return e.setHours(0,0,0,0),e}var z=864e5;function Q(t,e){f(2,arguments);var n=b(t),s=b(e),o=n.getTime()-B(n),i=s.getTime()-B(s);return Math.round((o-i)/z)}var V=6e4,Z=36e5;function O(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function P(t,e){f(2,arguments);var n=v(t),s=v(e),o=O(n,s),i=Math.abs(Q(n,s));n.setDate(n.getDate()-o*i);var c=+(O(n,s)===-o),d=o*(i-c);return d===0?0:d}function w(t,e){return f(2,arguments),v(t).getTime()-v(e).getTime()}var tt={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},et="trunc";function E(t){return tt[et]}function nt(t,e,n){f(2,arguments);var s=w(t,e)/Z;return E()(s)}function at(t,e,n){f(2,arguments);var s=w(t,e)/V;return E()(s)}function st(t,e,n){f(2,arguments);var s=w(t,e)/1e3;return E()(s)}let r={goal:"",targetDate:null,goalCreatedAt:null,tasks:[],doneTasks:[]};const a={countdown:document.getElementById("countdown"),days:document.getElementById("days"),hours:document.getElementById("hours"),minutes:document.getElementById("minutes"),seconds:document.getElementById("seconds"),goalTitle:document.getElementById("goalTitle"),addTaskBtn:document.getElementById("addTaskBtn"),todoList:document.getElementById("todoList"),doneList:document.getElementById("doneList"),settingsBtn:document.getElementById("settingsBtn"),settingsModal:document.getElementById("settingsModal"),taskModal:document.getElementById("taskModal"),taskInput:document.getElementById("taskInput"),taskDescription:document.getElementById("taskDescription"),saveTaskBtn:document.getElementById("saveTaskBtn"),closeTaskBtn:document.getElementById("closeTaskBtn"),goalInput:document.getElementById("goalInput"),dateInput:document.getElementById("dateInput"),saveSettingsBtn:document.getElementById("saveSettingsBtn"),closeSettingsBtn:document.getElementById("closeSettingsBtn"),listsContainer:document.querySelector(".lists-container"),prevList:document.getElementById("prevList"),nextList:document.getElementById("nextList"),activityMatrix:document.getElementById("activityMatrix"),activityStats:document.getElementById("activityStats"),activityTooltip:document.getElementById("activityTooltip")};let m=null,S=null;async function ot(){await it(),U(),vt(),dt()}async function it(){try{const t=await chrome.storage.sync.get(["goalState"]);if(t.goalState){const e=JSON.parse(t.goalState);r={goal:e.goal||"",targetDate:e.targetDate?new Date(e.targetDate):null,goalCreatedAt:e.goalCreatedAt?new Date(e.goalCreatedAt):null,tasks:Array.isArray(e.tasks)?e.tasks:[],doneTasks:Array.isArray(e.doneTasks)?e.doneTasks:[]}}}catch(t){console.error("Error loading state:",t),r={goal:"",targetDate:null,goalCreatedAt:null,tasks:[],doneTasks:[]}}}async function y(){try{const t={...r,targetDate:r.targetDate?r.targetDate.toISOString():null,goalCreatedAt:r.goalCreatedAt?r.goalCreatedAt.toISOString():null};await chrome.storage.sync.set({goalState:JSON.stringify(t)})}catch(t){console.error("Error saving state:",t)}}function U(){r.goal&&r.targetDate?(rt(),a.goalTitle.textContent=`${r.goal}`,k()):(a.goalTitle.textContent="Click to set your goal...",W()),D(),I()}function rt(){if(!r.targetDate)return"--";const t=new Date,e=new Date(r.targetDate);return Math.max(0,P(e,t))}function W(){a.days.textContent="--",a.hours.textContent="--",a.minutes.textContent="--",a.seconds.textContent="--"}function k(){if(!r.targetDate)return;const t=new Date,e=new Date(r.targetDate);if(t>=e){W();return}const n=P(e,t),s=nt(e,t)%24,o=at(e,t)%60,i=st(e,t)%60;a.days.textContent=String(n).padStart(2,"0"),a.hours.textContent=String(s).padStart(2,"0"),a.minutes.textContent=String(o).padStart(2,"0"),a.seconds.textContent=String(i).padStart(2,"0")}function dt(){k(),setInterval(k,1e3)}function ct(t,e=""){return{title:t,description:e,createdAt:Date.now(),updatedAt:Date.now()}}function j(t,e){return{...t,...e,updatedAt:Date.now()}}function N(t){return[...t].sort((e,n)=>n.updatedAt-e.updatedAt)}function H(t,e,n){const s=document.createElement("div");s.className="task-item",s.draggable=!0,s.dataset.index=e,s.dataset.list=n?"done":"todo";const o=document.createElement("h3");if(o.textContent=t.title,s.appendChild(o),t.description){const d=document.createElement("p");d.textContent=t.description,s.appendChild(d)}const i=document.createElement("div");i.className="task-time";const c=lt(t.updatedAt);return i.textContent=`Updated ${c}`,s.appendChild(i),s.addEventListener("dragstart",gt),s.addEventListener("click",()=>_(t,e,n)),s}function lt(t){const e=Date.now(),n=new Date(t),s=Math.floor((e-t)/1e3),o=Math.floor(s/60),i=Math.floor(o/60),c=Math.floor(i/24),d=n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),l=n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:n.getFullYear()!==new Date().getFullYear()?"numeric":void 0});return c===0&&n.getDate()===new Date().getDate()?`Today at ${d}`:c===1||c===0&&n.getDate()===new Date().getDate()-1?`Yesterday at ${d}`:`${l} at ${d}`}function D(){if(!a.todoList||!a.doneList)return;a.todoList.innerHTML="",a.doneList.innerHTML="";const t=N(r.tasks),e=N(r.doneTasks);t.forEach(n=>{const s=r.tasks.findIndex(i=>i===n),o=H(n,s,!1);a.todoList.appendChild(o)}),e.forEach(n=>{const s=r.doneTasks.findIndex(i=>i===n),o=H(n,s,!0);a.doneList.appendChild(o)})}function _(t=null,e=null,n=!1){m=e,S=n?"done":"todo",t?(a.taskInput.value=t.title,a.taskDescription.value=t.description||""):(a.taskInput.value="",a.taskDescription.value=""),a.taskModal.classList.add("show"),setTimeout(()=>a.taskInput.focus(),100)}function ut(t){t.key==="Enter"&&!t.shiftKey?(t.preventDefault(),J()):t.key==="Escape"&&(t.preventDefault(),p())}function J(){const t=a.taskInput.value.trim(),e=a.taskDescription.value.trim();if(t){if(m!==null){const n=S==="done"?r.doneTasks:r.tasks,s=n[m];n[m]=j(s,{title:t,description:e})}else r.tasks.push(ct(t,e));y(),D(),p()}}function p(){a.taskModal.classList.remove("show"),m=null,S=null}function gt(t){t.target.classList.add("dragging"),t.dataTransfer.setData("text/plain",JSON.stringify({index:t.target.dataset.index,list:t.target.dataset.list}))}function $(t){t.preventDefault();const e=t.target.closest(".task-list");e&&e.classList.add("drag-over")}function Y(t){const e=t.target.closest(".task-list");e&&!e.contains(t.relatedTarget)&&e.classList.remove("drag-over")}function F(t){t.preventDefault();const e=t.target.closest(".task-list");if(!e)return;e.classList.remove("drag-over");const n=JSON.parse(t.dataTransfer.getData("text/plain")),s=n.list==="todo"?r.tasks:r.doneTasks,o=e.id==="todoList"?r.tasks:r.doneTasks;if(s===o)return;const i=s[n.index];i&&(e.id==="doneList"?(i.completedAt=Date.now(),i.updatedAt=Date.now()):e.id==="todoList"&&(delete i.completedAt,i.updatedAt=Date.now()),s.splice(n.index,1),o.push(i),y(),D(),I())}function X(){r.goal&&(a.goalInput.value=r.goal),r.targetDate&&(a.dateInput.value=new Date(r.targetDate).toISOString().slice(0,16)),a.settingsModal.classList.add("show")}function T(){a.settingsModal.classList.remove("show")}function ft(){const t=a.goalInput.value.trim(),e=a.dateInput.value;t&&e&&((!r.goal||r.goal!==t)&&(r.goalCreatedAt=new Date),r.goal=t,r.targetDate=new Date(e),y(),U(),T())}function mt(t,e,n){const s=parseInt(t.dataset.index),o=e==="todo"?r.tasks:r.doneTasks,i=n==="todo"?r.tasks:r.doneTasks,c=o[s];if(c){const d=j(c,{});n==="done"?d.completedAt=Date.now():n==="todo"&&delete d.completedAt,o.splice(s,1),i.push(d),y(),D(),I()}}function pt(){if(!window.matchMedia("(max-width: 768px)").matches)return;const t=document.createElement("div");t.className="task-move-feedback",document.body.appendChild(t);let e=0,n=0;const s=50,o=500;function i(l,u){e=l.touches[0].clientX,n=Date.now(),u.classList.add("being-moved")}function c(l,u){const g=l.changedTouches[0].clientX,R=Date.now()-n,C=g-e;u.classList.remove("being-moved");const q=Math.abs(C)<s&&R<o,G=Math.abs(C)>s;if(q||G){const x=u.closest(".task-list").id==="todoList"?"todo":"done",A=x==="todo"?"done":"todo";t.textContent=`Moving to ${A==="todo"?"To-Do":"Done"}`,t.classList.add("visible"),a.listsContainer.classList.toggle("show-done"),setTimeout(()=>{mt(u,x,A),t.classList.remove("visible")},300)}}function d(l,u){const M=l.touches[0].clientX-e;Math.abs(M)>s&&l.preventDefault()}[a.todoList,a.doneList].forEach(l=>{l.addEventListener("touchstart",u=>{const g=u.target.closest(".task-item");g&&i(u,g)},{passive:!1}),l.addEventListener("touchend",u=>{const g=u.target.closest(".task-item");g&&c(u,g)}),l.addEventListener("touchmove",u=>{u.target.closest(".task-item")&&d(u)},{passive:!1})})}function vt(){a.addTaskBtn.addEventListener("click",()=>_()),a.saveTaskBtn.addEventListener("click",J),a.closeTaskBtn.addEventListener("click",p),a.settingsBtn.addEventListener("click",X),a.closeSettingsBtn.addEventListener("click",T),a.saveSettingsBtn.addEventListener("click",ft),a.nextList.addEventListener("click",()=>{a.listsContainer.classList.add("show-done")}),a.prevList.addEventListener("click",()=>{a.listsContainer.classList.remove("show-done")}),a.taskInput.addEventListener("keydown",ut),a.taskDescription.addEventListener("keydown",t=>{t.key==="Escape"&&(t.preventDefault(),p())}),pt(),window.matchMedia("(max-width: 768px)").matches||(a.todoList.addEventListener("dragover",$),a.todoList.addEventListener("dragleave",Y),a.todoList.addEventListener("drop",F),a.doneList.addEventListener("dragover",$),a.doneList.addEventListener("dragleave",Y),a.doneList.addEventListener("drop",F)),a.goalTitle.addEventListener("click",X),window.addEventListener("click",t=>{t.target===a.taskModal&&p(),t.target===a.settingsModal&&T()})}function I(){if(!a.activityMatrix||!r.goalCreatedAt)return;const t=yt();Tt(t),Et(t)}function yt(){const t=Dt(),e=new Date,n=[],s=t.getDay();t.setDate(t.getDate()-s);const o=new Date(t);for(;o<=e;){const c=L(o),d=ht(c);n.push({date:new Date(o),dateStr:c,count:d,level:kt(d),dayOfWeek:o.getDay()}),o.setDate(o.getDate()+1)}const i=e.getDay();if(i<6){const c=6-i,d=new Date(e);for(let l=1;l<=c;l++)d.setDate(d.getDate()+1),n.push({date:new Date(d),dateStr:L(d),count:0,level:0,dayOfWeek:d.getDay()})}return n}function Dt(){let t=r.goalCreatedAt?new Date(r.goalCreatedAt):new Date;const e=[...r.tasks,...r.doneTasks];if(e.length>0){const n=Math.min(...e.map(o=>o.createdAt||Date.now())),s=new Date(n);s<t&&(t=s)}return t.setHours(0,0,0,0),t}function L(t){return t.toISOString().split("T")[0]}function ht(t){return r.doneTasks.filter(e=>{if(!e.completedAt)return!1;const n=new Date(e.completedAt);return L(n)===t}).length}function kt(t){return t===0?0:t<=2?1:t<=4?2:t<=6?3:4}function Tt(t){a.activityMatrix.innerHTML="",t.forEach(e=>{const n=document.createElement("div");n.className=`matrix-day matrix-day-${e.level}`,n.dataset.date=e.dateStr,n.dataset.count=e.count,n.addEventListener("mouseenter",Lt),n.addEventListener("mouseleave",wt),n.addEventListener("mousemove",K),a.activityMatrix.appendChild(n)})}function Lt(t){const e=t.target,n=new Date(e.dataset.date),s=parseInt(e.dataset.count),o=n.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),c=`${s} ${s===1?"task":"tasks"} completed on ${o}`;a.activityTooltip.textContent=c,a.activityTooltip.classList.add("visible"),K(t)}function wt(){a.activityTooltip.classList.remove("visible")}function K(t){const e=a.activityTooltip.getBoundingClientRect();let n=t.clientY+20,s=t.clientX+10;s+e.width>window.innerWidth-8&&(s=t.clientX-e.width-10),n+e.height>window.innerHeight-8&&(n=t.clientY-e.height-10),a.activityTooltip.style.position="fixed",a.activityTooltip.style.top=`${n}px`,a.activityTooltip.style.left=`${s}px`}function Et(t){if(!a.activityStats)return;t.length;const e=t.filter(o=>o.count>0).length,n=t.reduce((o,i)=>o+i.count,0),s=St(t);a.activityStats.textContent=`${n} tasks completed across ${e} days (${s} day streak)`}function St(t){let e=0;for(let n=t.length-1;n>=0&&t[n].count>0;n--)e++;return e}ot();
