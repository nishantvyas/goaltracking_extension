(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();function D(t){"@babel/helpers - typeof";return D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(t)}function f(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function v(t){f(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||D(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function B(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function A(t){f(1,arguments);var e=v(t);return e.setHours(0,0,0,0),e}var z=864e5;function Q(t,e){f(2,arguments);var n=A(t),s=A(e),o=n.getTime()-B(n),r=s.getTime()-B(s);return Math.round((o-r)/z)}var V=6e4,Z=36e5;function b(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function X(t,e){f(2,arguments);var n=v(t),s=v(e),o=b(n,s),r=Math.abs(Q(n,s));n.setDate(n.getDate()-o*r);var c=+(b(n,s)===-o),d=o*(r-c);return d===0?0:d}function L(t,e){return f(2,arguments),v(t).getTime()-v(e).getTime()}var tt={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},et="trunc";function E(t){return tt[et]}function nt(t,e,n){f(2,arguments);var s=L(t,e)/Z;return E()(s)}function at(t,e,n){f(2,arguments);var s=L(t,e)/V;return E()(s)}function st(t,e,n){f(2,arguments);var s=L(t,e)/1e3;return E()(s)}let i={goal:"",targetDate:null,goalCreatedAt:null,tasks:[],doneTasks:[]};const a={countdown:document.getElementById("countdown"),days:document.getElementById("days"),hours:document.getElementById("hours"),minutes:document.getElementById("minutes"),seconds:document.getElementById("seconds"),goalTitle:document.getElementById("goalTitle"),addTaskBtn:document.getElementById("addTaskBtn"),todoList:document.getElementById("todoList"),doneList:document.getElementById("doneList"),settingsBtn:document.getElementById("settingsBtn"),settingsModal:document.getElementById("settingsModal"),taskModal:document.getElementById("taskModal"),taskInput:document.getElementById("taskInput"),taskDescription:document.getElementById("taskDescription"),saveTaskBtn:document.getElementById("saveTaskBtn"),closeTaskBtn:document.getElementById("closeTaskBtn"),goalInput:document.getElementById("goalInput"),dateInput:document.getElementById("dateInput"),saveSettingsBtn:document.getElementById("saveSettingsBtn"),closeSettingsBtn:document.getElementById("closeSettingsBtn"),listsContainer:document.querySelector(".lists-container"),prevList:document.getElementById("prevList"),nextList:document.getElementById("nextList"),activityMatrix:document.getElementById("activityMatrix"),activityStats:document.getElementById("activityStats"),activityTooltip:document.getElementById("activityTooltip")};let m=null,w=null;async function ot(){await it(),P(),vt(),ct()}async function it(){try{const t=await chrome.storage.sync.get(["goalState"]);if(t.goalState){const e=JSON.parse(t.goalState);i={goal:e.goal||"",targetDate:e.targetDate?new Date(e.targetDate):null,goalCreatedAt:e.goalCreatedAt?new Date(e.goalCreatedAt):null,tasks:Array.isArray(e.tasks)?e.tasks:[],doneTasks:Array.isArray(e.doneTasks)?e.doneTasks:[]}}}catch(t){console.error("Error loading state:",t),i={goal:"",targetDate:null,goalCreatedAt:null,tasks:[],doneTasks:[]}}}async function y(){try{const t={...i,targetDate:i.targetDate?i.targetDate.toISOString():null,goalCreatedAt:i.goalCreatedAt?i.goalCreatedAt.toISOString():null};await chrome.storage.sync.set({goalState:JSON.stringify(t)})}catch(t){console.error("Error saving state:",t)}}function P(){i.goal&&i.targetDate?(rt(),a.goalTitle.textContent=`${i.goal}`,k()):(a.goalTitle.textContent="Click to set your goal...",U()),h(),S()}function rt(){if(!i.targetDate)return"--";const t=new Date,e=new Date(i.targetDate);return Math.max(0,X(e,t))}function U(){a.days.textContent="--",a.hours.textContent="--",a.minutes.textContent="--",a.seconds.textContent="--"}function k(){if(!i.targetDate)return;const t=new Date,e=new Date(i.targetDate);if(t>=e){U();return}const n=X(e,t),s=nt(e,t)%24,o=at(e,t)%60,r=st(e,t)%60;a.days.textContent=String(n).padStart(2,"0"),a.hours.textContent=String(s).padStart(2,"0"),a.minutes.textContent=String(o).padStart(2,"0"),a.seconds.textContent=String(r).padStart(2,"0")}function ct(){k(),setInterval(k,1e3)}function dt(t,e=""){return{title:t,description:e,createdAt:Date.now(),updatedAt:Date.now()}}function j(t,e){return{...t,...e,updatedAt:Date.now()}}function O(t){return[...t].sort((e,n)=>n.updatedAt-e.updatedAt)}function N(t,e,n){const s=document.createElement("div");s.className="task-item",s.draggable=!0,s.dataset.index=e,s.dataset.list=n?"done":"todo";const o=document.createElement("h3");if(o.textContent=t.title,s.appendChild(o),t.description){const d=document.createElement("p");d.textContent=t.description,s.appendChild(d)}const r=document.createElement("div");r.className="task-time";const c=lt(t.updatedAt);return r.textContent=`Updated ${c}`,s.appendChild(r),s.addEventListener("dragstart",gt),s.addEventListener("click",()=>_(t,e,n)),s}function lt(t){const e=Date.now(),n=new Date(t),s=Math.floor((e-t)/1e3),o=Math.floor(s/60),r=Math.floor(o/60),c=Math.floor(r/24),d=n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),u=n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:n.getFullYear()!==new Date().getFullYear()?"numeric":void 0});return c===0&&n.getDate()===new Date().getDate()?`Today at ${d}`:c===1||c===0&&n.getDate()===new Date().getDate()-1?`Yesterday at ${d}`:`${u} at ${d}`}function h(){if(!a.todoList||!a.doneList)return;a.todoList.innerHTML="",a.doneList.innerHTML="";const t=O(i.tasks),e=O(i.doneTasks);t.forEach((n,s)=>{const o=N(n,s,!1);a.todoList.appendChild(o)}),e.forEach((n,s)=>{const o=N(n,s,!0);a.doneList.appendChild(o)})}function _(t=null,e=null,n=!1){m=e,w=n?"done":"todo",t?(a.taskInput.value=t.title,a.taskDescription.value=t.description||""):(a.taskInput.value="",a.taskDescription.value=""),a.taskModal.classList.add("show"),setTimeout(()=>a.taskInput.focus(),100)}function ut(t){t.key==="Enter"&&!t.shiftKey?(t.preventDefault(),J()):t.key==="Escape"&&(t.preventDefault(),p())}function J(){const t=a.taskInput.value.trim(),e=a.taskDescription.value.trim();if(t){if(m!==null){const n=w==="done"?i.doneTasks:i.tasks,s=n[m];n[m]=j(s,{title:t,description:e})}else i.tasks.push(dt(t,e));y(),h(),p()}}function p(){a.taskModal.classList.remove("show"),m=null,w=null}function gt(t){t.target.classList.add("dragging"),t.dataTransfer.setData("text/plain",JSON.stringify({index:t.target.dataset.index,list:t.target.dataset.list}))}function H(t){t.preventDefault();const e=t.target.closest(".task-list");e&&e.classList.add("drag-over")}function $(t){const e=t.target.closest(".task-list");e&&!e.contains(t.relatedTarget)&&e.classList.remove("drag-over")}function Y(t){t.preventDefault();const e=t.target.closest(".task-list");if(!e)return;e.classList.remove("drag-over");const n=JSON.parse(t.dataTransfer.getData("text/plain")),s=n.list==="todo"?i.tasks:i.doneTasks,o=e.id==="todoList"?i.tasks:i.doneTasks;if(s===o)return;const r=s[n.index];r&&(e.id==="doneList"?(r.completedAt=Date.now(),r.updatedAt=Date.now()):e.id==="todoList"&&(delete r.completedAt,r.updatedAt=Date.now()),s.splice(n.index,1),o.push(r),y(),h(),S())}function F(){i.goal&&(a.goalInput.value=i.goal),i.targetDate&&(a.dateInput.value=new Date(i.targetDate).toISOString().slice(0,16)),a.settingsModal.classList.add("show")}function T(){a.settingsModal.classList.remove("show")}function ft(){const t=a.goalInput.value.trim(),e=a.dateInput.value;t&&e&&((!i.goal||i.goal!==t)&&(i.goalCreatedAt=new Date),i.goal=t,i.targetDate=new Date(e),y(),P(),T())}function mt(t,e,n){const s=parseInt(t.dataset.index),o=e==="todo"?i.tasks:i.doneTasks,r=n==="todo"?i.tasks:i.doneTasks,c=o[s];if(c){const d=j(c,{});n==="done"?d.completedAt=Date.now():n==="todo"&&delete d.completedAt,o.splice(s,1),r.push(d),y(),h(),S()}}function pt(){if(!window.matchMedia("(max-width: 768px)").matches)return;const t=document.createElement("div");t.className="task-move-feedback",document.body.appendChild(t);let e=0,n=0;const s=50,o=500;function r(u,l){e=u.touches[0].clientX,n=Date.now(),l.classList.add("being-moved")}function c(u,l){const g=u.changedTouches[0].clientX,q=Date.now()-n,M=g-e;l.classList.remove("being-moved");const G=Math.abs(M)<s&&q<o,W=Math.abs(M)>s;if(G||W){const C=l.closest(".task-list").id==="todoList"?"todo":"done",x=C==="todo"?"done":"todo";t.textContent=`Moving to ${x==="todo"?"To-Do":"Done"}`,t.classList.add("visible"),a.listsContainer.classList.toggle("show-done"),setTimeout(()=>{mt(l,C,x),t.classList.remove("visible")},300)}}function d(u,l){const I=u.touches[0].clientX-e;Math.abs(I)>s&&u.preventDefault()}[a.todoList,a.doneList].forEach(u=>{u.addEventListener("touchstart",l=>{const g=l.target.closest(".task-item");g&&r(l,g)},{passive:!1}),u.addEventListener("touchend",l=>{const g=l.target.closest(".task-item");g&&c(l,g)}),u.addEventListener("touchmove",l=>{l.target.closest(".task-item")&&d(l)},{passive:!1})})}function vt(){a.addTaskBtn.addEventListener("click",()=>_()),a.saveTaskBtn.addEventListener("click",J),a.closeTaskBtn.addEventListener("click",p),a.settingsBtn.addEventListener("click",F),a.closeSettingsBtn.addEventListener("click",T),a.saveSettingsBtn.addEventListener("click",ft),a.nextList.addEventListener("click",()=>{a.listsContainer.classList.add("show-done")}),a.prevList.addEventListener("click",()=>{a.listsContainer.classList.remove("show-done")}),a.taskInput.addEventListener("keydown",ut),a.taskDescription.addEventListener("keydown",t=>{t.key==="Escape"&&(t.preventDefault(),p())}),pt(),window.matchMedia("(max-width: 768px)").matches||(a.todoList.addEventListener("dragover",H),a.todoList.addEventListener("dragleave",$),a.todoList.addEventListener("drop",Y),a.doneList.addEventListener("dragover",H),a.doneList.addEventListener("dragleave",$),a.doneList.addEventListener("drop",Y)),a.goalTitle.addEventListener("click",F),window.addEventListener("click",t=>{t.target===a.taskModal&&p(),t.target===a.settingsModal&&T()})}function S(){if(!a.activityMatrix||!i.goalCreatedAt)return;const t=yt();Tt(t),wt(t)}function yt(){const t=ht(),e=new Date,n=[],s=new Date(t);for(;s<=e;){const o=K(s),r=Dt(o);n.push({date:new Date(s),dateStr:o,count:r,level:kt(r)}),s.setDate(s.getDate()+1)}return n}function ht(){let t=i.goalCreatedAt?new Date(i.goalCreatedAt):new Date;const e=[...i.tasks,...i.doneTasks];if(e.length>0){const n=Math.min(...e.map(o=>o.createdAt||Date.now())),s=new Date(n);s<t&&(t=s)}return t.setHours(0,0,0,0),t}function K(t){return t.toISOString().split("T")[0]}function Dt(t){return i.doneTasks.filter(e=>{if(!e.completedAt)return!1;const n=new Date(e.completedAt);return K(n)===t}).length}function kt(t){return t===0?0:t<=2?1:t<=4?2:t<=6?3:4}function Tt(t){a.activityMatrix.innerHTML="",t.forEach(e=>{const n=document.createElement("div");n.className=`matrix-day matrix-day-${e.level}`,n.dataset.date=e.dateStr,n.dataset.count=e.count,n.addEventListener("mouseenter",Lt),n.addEventListener("mouseleave",Et),n.addEventListener("mousemove",R),a.activityMatrix.appendChild(n)})}function Lt(t){const e=t.target,n=new Date(e.dataset.date),s=parseInt(e.dataset.count),o=n.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),c=`${s} ${s===1?"task":"tasks"} completed on ${o}`;a.activityTooltip.textContent=c,a.activityTooltip.classList.add("visible"),R(t)}function Et(){a.activityTooltip.classList.remove("visible")}function R(t){const e=a.activityTooltip.getBoundingClientRect();let n=t.clientY+20,s=t.clientX+10;s+e.width>window.innerWidth-8&&(s=t.clientX-e.width-10),n+e.height>window.innerHeight-8&&(n=t.clientY-e.height-10),a.activityTooltip.style.position="fixed",a.activityTooltip.style.top=`${n}px`,a.activityTooltip.style.left=`${s}px`}function wt(t){if(!a.activityStats)return;t.length;const e=t.filter(o=>o.count>0).length,n=t.reduce((o,r)=>o+r.count,0),s=St(t);a.activityStats.textContent=`${n} tasks completed across ${e} days (${s} day streak)`}function St(t){let e=0;for(let n=t.length-1;n>=0&&t[n].count>0;n--)e++;return e}ot();
